type timekeep, domain, domain_deprecated;
type timekeep_exec, exec_type, file_type;

# Started by init
init_daemon_domain(timekeep)

allow timekeep self:capability { fowner fsetid sys_time dac_override dac_read_search };

allow timekeep rtc_device:chr_file r_file_perms;
allow timekeep alarm_device:chr_file rw_file_perms;

allow timekeep time_data_file:file { create_file_perms getattr };
allow timekeep time_data_file:dir { create_dir_perms search };

set_prop(timekeep, timekeep_prop)

r_dir_file(timekeep, sysfs_timekeep)